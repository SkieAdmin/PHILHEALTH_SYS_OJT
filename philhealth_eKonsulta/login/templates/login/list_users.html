{% extends 'base.html' %}
{% block title %}Manage Users{% endblock %}
{% block content %}
<script>
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('registered') === 'doctor') {
        alert('Successfully Registered');
        window.history.replaceState({}, document.title, '/list-users/');
    }
</script>
<h2>All Accounts</h2>

<!-- (Added by Gocotano) Implementing Search Filter, then refresh the site with the parameter of search_query. -->
<form method="GET" action="">
    <label for="search_query">Search by Name:</label>
    <input type="text" id="search_query" name="search_query" value="{{ request.GET.search_query|default_if_none:'' }}">
    <button type="submit">Search</button>
</form>


<table border="1">
    <tr>
        <th>No.</th>
        <th>Full Name</th>
        <th>Username</th>
        <th>Role</th>
        <th>Actions</th>
    </tr>
    {% for item in user_list %}
    <tr>
        <td>{{ forloop.counter }}</td> <!-- Count2 shit lmfao -->
        <td>{{ item.full_name|default:"N/A" }}</td>
        <td>{{ item.user.username }}</td>
        <td>{{ item.user.role }}</td>
        <td>
            <a href="{% url 'view_user' item.user.id %}">View</a> |
            <a href="{% url 'update_user' item.user.id %}">Edit</a> |
            <a href="{% url 'delete_user' item.user.id %}">Delete</a>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="4">No users found.</td>
    </tr>
    {% endfor %}
</table>

<a href="{% url 'superadmin_dashboard'%}">Back</a>
{% endblock %}